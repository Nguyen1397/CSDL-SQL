CREATE DATABASE Asm3
GO

USE Asm3
GO

CREATE TABLE KhachHang
(
	HoTen NVARCHAR(20),
	CCCD CHAR(10) PRIMARY KEY,
	DiaChi NVARCHAR(50)
)
GO

CREATE TABLE ThueBao
(
	CCCD CHAR(10) FOREIGN KEY REFERENCES KhachHang(CCCD),
	SoTB CHAR(12) PRIMARY KEY,
	LoaiTB NVARCHAR(20),
	NgayDK DATETIME
)
GO

--3
INSERT KhachHang VALUES (N'Nguyễn Nguyệt Nga',123456789,N'Hà Nội')
INSERT KhachHang VALUES (N'Phạm Thiên Du',223456789,N'An Giang')
INSERT KhachHang VALUES (N'Trần Thái Hà',323456789,N'Nam Định')

INSERT ThueBao VALUES (123456789,'0973114526',N'Trả trước','2012-12-09')
INSERT ThueBao VALUES (123456789,'0917548394',N'Trả sau','2013-05-14')
INSERT ThueBao VALUES (223456789,'0522098161',N'Trả trước','2016-08-04')
INSERT ThueBao VALUES (323456789,'0911192874',N'Trả sau','2018-09-23')
INSERT ThueBao VALUES (323456789,'0332789817',N'Trả trước','2014-05-17')
GO
SELECT * FROM ThueBao 
SELECT * FROM KhachHang

--2
SELECT KH.*, TB.SoTB,LoaiTB,NgayDK FROM KhachHang AS KH
JOIN ThueBao AS TB ON KH.CCCD = TB.CCCD
WHERE KH.CCCD = 123456789

--4
---a
SELECT * FROM KhachHang
---b
SELECT * FROM ThueBao

--5
---a
SELECT * FROM ThueBao
WHERE SoTB = '0123456789'
---b
SELECT * FROM KhachHang
WHERE CCCD = 123456789
---c
SELECT SoTB FROM ThueBao
WHERE CCCD = 123456789
---d
SELECT SoTB FROM ThueBao
WHERE NgayDK = '2012-12-09'
---e
SELECT TB.SoTB FROM ThueBao AS TB
JOIN KhachHang AS KH ON TB.CCCD = KH.CCCD
WHERE KH.DiaChi = N'Hà Nội'

--6
---a
SELECT COUNT(*) FROM KhachHang
---b
SELECT COUNT(SoTB) FROM ThueBao
---c
SELECT COUNT(SoTB) FROM ThueBao
WHERE ThueBao.NgayDK = '2012-12-09'
---d
SELECT KH.*, TB.SoTB,LoaiTB,NgayDK FROM KhachHang AS KH
JOIN ThueBao AS TB ON KH.CCCD = TB.CCCD